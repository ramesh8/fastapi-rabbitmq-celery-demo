{% extends "_base.html" %} {% block content %}

<div class="mt-3 row" data-masonry='{"percentPosition": true }'>
  {% for m in mails %}

  <div class="col-sm-6 mb-4">
    <div class="card">
      <div
        class="card-header {{ 'bg-success' if m['status']==True else 'bg-danger' }} text-white d-flex justify-content-between align-items-center"
      >
        <span><i class="fa-regular fa-user"></i> {{ m['sender'] }}</span>
        <span class="badge badge-light badge-pill">{{ m['subject'] }}</span>
      </div>
      <ul class="list-group list-group-flush">
        {% for fs in m['files'] %}

        <li
          class="list-group-item d-flex justify-content-between align-items-center"
        >
          <span><i class="fa-regular fa-file"></i> {{ fs['fname']}} </span>
          <div class="btn-group" role="group">
            <button
              type="button"
              class="btn btn-sm {{ 'btn-success' if fs['stage']['name']=='SA' else 'btn-outline-secondary' }}"
            >
              <i class="fa-solid fa-cloud-arrow-up"></i> S3
              <span class="badge badge-light">{{fs['filestages']['SA']}}</span>
            </button>
            <button
              type="button"
              class="btn btn-sm {{ 'btn-success' if fs['stage']['name']=='Conv' else 'btn-outline-secondary' }}"
            >
              <i class="fa-regular fa-file-pdf"></i> Con
              <span class="badge badge-light"
                >{{fs['filestages']['Conv']}}</span
              >
            </button>
            <button
              type="button"
              class="btn btn-sm {{ 'btn-success' if fs['stage']['name']=='Ext' else 'btn-outline-secondary' }}"
            >
              <i class="fa-solid fa-magnifying-glass"></i> Ext
              <span class="badge badge-light">{{fs['filestages']['Ext']}}</span>
            </button>
            <button
              type="button"
              class="btn btn-sm {{ 'btn-success' if fs['stage']['name']=='GBO' else 'btn-outline-secondary' }}"
            >
              <i class="fa-solid fa-database"></i> DB
              <span class="badge badge-light">{{fs['filestages']['GBO']}}</span>
            </button>
          </div>
        </li>
        {% endfor %}
      </ul>
    </div>
  </div>
  {% endfor %}
  <!-- </ul> -->
</div>

<div class="mt-3 row" data-masonry='{"percentPosition": true }'>
  <div class="col-sm-6 mb-4">
    <!-- <h2>Mails</h2> -->
    <small>
      <ul class="list-group">
        <li class="list-group-item bg-secondary text-white">Todo:</li>
        <li class="list-group-item">enqueue mails ✔</li>
        <li class="list-group-item">celery tasks for files ✔</li>
        <li class="list-group-item">
          show mails with subject, attachmet filenames ✔
        </li>
        <li class="list-group-item">
          show progress of each attachment stage-wise ✔
        </li>
        <li class="list-group-item">update mail status upon stage update ✔</li>
        <li class="list-group-item">show Time taken for each stage ✔</li>

        <li class="list-group-item">Toggle Auto Subscription (1hr)</li>
        <li class="list-group-item">Show Subscription Status (1hr)</li>
        <li class="list-group-item">Accordian on Cards (0.5hr)</li>
        <li class="list-group-item">Toggle Hide Finished (0.5hr)</li>

        <li class="list-group-item">Date Filter (0.5hr)</li>
        <li class="list-group-item">Partial Text Search (1hr)</li>
        <li class="list-group-item">Ideal Time (1hr)</li>
      </ul>
    </small>
  </div>
</div>
<script>
  setTimeout(function () {
    window.location.reload(1);
  }, 5000);
</script>
<style>
  .badge {
    font-weight: 100;
  }
  .list-group-item {
    text-transform: lowercase;
  }
</style>
{% endblock %}
